/*!
 * Notification.js
 *
 * A well designed, highly customizable and lightweigth notification library.
 *
 * @author 	   Dominique Müller <dominique.m.mueller@gmail.com>
 * @copyright  Dominique Müller 2015
 * @license    MIT <http://opensource.org/licenses/MIT>
 * @link 	   Github <https://github.com/dominique-mueller/notification-js>
 * @version    1.0.0
 */
!function(a,b,c){"use strict";!function(a){function d(a,d){d=d||{bubbles:!1,cancelable:!1,detail:c};var e=b.createEvent("CustomEvent");return e.initCustomEvent(a,d.bubbles,d.cancelable,d.detail),e}d.prototype=a.Event.prototype,a.CustomEvent=d}(a);var d={global:{notification:{position:["left","bottom"],distances:[20,20,10],height:60,roundCorners:[1,1,1,1],color:"#555"},symbol:{visible:!1,resource:!1,roundCorners:!1,color:"rgba(0,0,0,.1)"},message:{visible:!0,color:"#FFF",textSize:14},dismiss:{visible:!0,color:"#FFF",text:!1},behaviour:{autoHide:5,onMouseover:"pause",stacking:!0,limit:!0,htmlMode:!1},animations:{enabled:!0,duration:[.75,.75],easing:["ease","ease"]},callbacks:{onOpen:!1,onOpened:!1,onClose:!1,onClosed:!1,onDismiss:!1,onMouseenter:!1,onMouseleave:!1}},default:{notification:{color:"#555"}},info:{notification:{color:"#2574A9"}},success:{notification:{color:"#239D58"},symbol:{visible:!0}},error:{notification:{color:"#B9493E"},symbol:{visible:!0}},warning:{notification:{color:"#C7932F"}}},e={success:'<svg viewBox="0 0 24 24" height="24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="4,12.5 9,17.5 20,6.5" fill="none" stroke="#FFF" stroke-width="2" stroke-dasharray="23" /></svg>',error:'<svg viewBox="0 0 24 24" height="24" width="24" xmlns="http://www.w3.org/2000/svg"><line x1="6" y1="6" x2="18" y2="18" stroke="#FFF" stroke-width="2" stroke-dasharray="17" /><line x1="6" y1="18" x2="18" y2="6" stroke="#FFF" stroke-width="2" stroke-dasharray="17" /></svg>'},f=function(a,b,c){this.profile="undefined"!=typeof d[a]?a:"default",this.message=b,this.options="undefined"!=typeof c?c:{},this.$components={},this.initialize()};f.instances=[],f.prototype.EVENTS={onOpen:new CustomEvent("notification.open"),onOpened:new CustomEvent("notification.opened"),onClose:new CustomEvent("notification.close"),onClosed:new CustomEvent("notification.closed"),onDismiss:new CustomEvent("notification.dismiss"),onMouseenter:new CustomEvent("notification.mouseenter"),onMouseleave:new CustomEvent("notification.mouseleave")},f.prototype.initialize=function(){function a(){for(var a=arguments.length,b={},c=a-1;c>0;c--)"undefined"==typeof arguments[c]&&delete arguments[c];for(var d in arguments[0])for(var e=a-1;e>=0;e--)if("undefined"!=typeof arguments[e]&&arguments[e].hasOwnProperty(d)){b[d]=arguments[e][d];break}return b}var b=this,c={};for(var f in d.global)c[f]=a(d.global[f],d[b.profile][f],b.options[f]);if(!c.symbol.resource)switch(b.profile){case"success":c.symbol.resource=e.success;break;case"error":c.symbol.resource=e.error;break;default:c.symbol.visible=!1}b.options=c},f.prototype.build=function(a){function c(){var a=b.createElement("div"),c=k.position[0],d=k.position[1],e=k.distances[0],f=k.distances[1],g=k.height,h=k.roundCorners;switch(c){case"left":a.style.left=e+"px",a.style.marginRight=e+"px";break;case"right":a.style.right=e+"px",a.style.marginLeft=e+"px";break;case"middle":a.style.left="50%",a.style.webkitTransform="translateX(-50%)",a.style.transform="translateX(-50%)"}switch(d){case"top":a.style.top=f+"px";break;case"bottom":a.style.bottom=f+"px"}return l.visible&&(a.style.paddingLeft=g+"px"),h&&h[0]+h[1]+h[2]+h[3]>0&&(a.style.borderRadius=h.join("px ")+"px"),n.visible&&!n.text&&(a.style.paddingRight=g-20+"px"),a.classList.add("notification"),a.classList.add("notification-"+i.profile),a}function d(){var a=b.createElement("div"),c=k.height/2,d=k.color;return a.style.left="calc(-100% + "+c+"px)",a.style.backgroundColor=d,a.classList.add("notification-background"),a}function f(){var a,c=k.height,d=l.resource,e=l.roundCorners,f=l.color;if(null!==d.match(/^<svg.*>.*<\/svg>$/i)||"function"==typeof d){if("function"==typeof d){if(a=d(),"undefined"==typeof a||"svg"!==a.nodeName.toLowerCase())throw new Error("The custom notification symbol is not valid svg.")}else a=(new DOMParser).parseFromString(d,"image/svg+xml").childNodes[0];a.setAttributeNS(null,"width","24"),a.setAttributeNS(null,"height","24"),e&&e[0]+e[1]+e[2]+e[3]>0?a.style.padding=c/2-17+"px":a.style.padding=c/2-12+"px",f&&(a.style.backgroundColor=f)}else a=b.createElement("div"),a.style.backgroundImage='url("'+d+'")',a.style.backgroundPosition="center",a.style.backgroundSize="cover",a.style.backgroundRepeat="no-repeat";return e&&e[0]+e[1]+e[2]+e[3]>0?(a.style.left="5px",a.style.height=c-10+"px",a.style.width=c-10+"px",a.style.borderRadius=e.join("px ")+"px"):(a.style.left="0",a.style.height="100%",a.style.width=c+"px"),a.setAttributeNS(null,"class","notification-symbol notification-symbol-"+i.profile),a}function g(){var a=b.createElement("p"),c=m.color,d=m.textSize,e=Math.round(1.7*d),f=Math.round(k.height/2.75),g=Math.round((k.height-e)/2);return o.htmlMode?a.innerHTML=i.message:a.textContent=i.message,a.style.color=c,a.style.fontSize=d+"px",a.style.lineHeight=e+"px",a.style.padding=g+"px "+f+"px",a.classList.add("notification-message"),a}function h(){var a=b.createElement("button"),c=k.height,d=n.color,f=n.text;if(a.setAttribute("type","button"),a.setAttribute("title","dismiss this notification"),a.style.height=c-20+"px",a.style.padding=c/2-18+"px",f)a.textContent=f,a.style.color=d,a.style.fontSize="12px",a.style.lineHeight="16px";else{var g=(new DOMParser).parseFromString(e.error,"image/svg+xml").childNodes[0];g.setAttributeNS(null,"width","16"),g.setAttributeNS(null,"height","16"),a.appendChild(g),a.style.width=c-20+"px"}return a.classList.add("notification-btn"),a}var i=this,j=b.createDocumentFragment(),k=i.options.notification,l=i.options.symbol,m=i.options.message,n=i.options.dismiss,o=i.options.behaviour;i.$components.notification=c(),i.$components.background=d(),i.$components.notification.appendChild(i.$components.background),l.visible&&(i.$components.symbol=f(),i.$components.notification.appendChild(i.$components.symbol)),m.visible&&(i.$components.message=g(),i.$components.notification.appendChild(i.$components.message)),n.visible&&(i.$components.button=h(),i.$components.notification.appendChild(i.$components.button)),j.appendChild(i.$components.notification),b.body.appendChild(j),n.visible&&n.text&&(i.$components.notification.style.paddingRight=i.$components.button.offsetWidth+"px"),i.next(a)},f.prototype.prepare=function(b){var c=this;if(f.instances.length)if(c.options.behaviour.stacking){var d,e=c.options.behaviour.limit,g=f.instances.length,h=c.$components.notification.offsetHeight;if(e===!0||0>e){var i=c.options.notification,j=i.height,k=i.distances[1],l=i.distances[2],m=h+2*k+g*l;f.instances.forEach(function(a){m+=a.$components.notification.offsetHeight}),0>e&&(m-=(j+l)*e),d=m>a.innerHeight?!0:!1}else d=e!==!1&&0!==e&&g===e?!0:!1;d?f.instances[0].close(function(){c.shift(f.instances,"up",h,function(){c.next(b)})}):c.shift(f.instances,"up",h,function(){c.next(b)})}else f.instances[0].close(function(){c.next(b)});else c.next(b)},f.prototype.open=function(a){var c=this;f.instances.push(c),b.dispatchEvent(c.EVENTS.onOpen),"function"==typeof c.options.callbacks.onOpen&&c.options.callbacks.onOpen(),c.animate("in",function(){b.dispatchEvent(c.EVENTS.onOpened),"function"==typeof c.options.callbacks.onOpened&&c.options.callbacks.onOpened(),c.next(a)})},f.prototype.wait=function(a){var c=this;if(c.options.behaviour.autoHide){var d=new g(1e3*c.options.behaviour.autoHide,function(){c.next(a)});c.options.behaviour.onMouseover&&(c.$components.notification.addEventListener("mouseenter",function(){switch(b.dispatchEvent(c.EVENTS.onMouseenter),"function"==typeof c.options.callbacks.onMouseenter&&c.options.callbacks.onMouseenter(),c.options.behaviour.onMouseover){case"pause":d.pause();break;case"reset":d.stop()}}),c.$components.notification.addEventListener("mouseleave",function(){b.dispatchEvent(c.EVENTS.onMouseleave),"function"==typeof c.options.callbacks.onMouseleave&&c.options.callbacks.onMouseleave(),d.resume()}))}c.options.dismiss.visible&&c.$components.button.addEventListener("click",function e(f){f.target.removeEventListener(f.type,e),b.dispatchEvent(c.EVENTS.onDismiss),"function"==typeof c.options.callbacks.onDismiss&&c.options.callbacks.onDismiss(),c.options.behaviour.autoHide&&d.stop(),c.next(a)})},f.prototype.close=function(a){var c=this;b.dispatchEvent(c.EVENTS.onClose),"function"==typeof c.options.callbacks.onClose&&c.options.callbacks.onClose(),c.animate("out",function(){if(b.dispatchEvent(c.EVENTS.onClosed),"function"==typeof c.options.callbacks.onClosed&&c.options.callbacks.onClosed(),c.options.behaviour.stacking&&f.instances.length-1){var d=f.instances.indexOf(c),e=c.$components.notification.offsetHeight;c.shift(f.instances.slice(0,d),"down",e,function(){f.instances.splice(d,1),c.next(a)})}else f.instances=[],c.next(a);b.body.removeChild(c.$components.notification)})},f.prototype.animate=function(a,b){function c(){return d.$components.notification.offsetWidth}var d=this,e=d.options.animations.duration[0],f=d.options.animations.duration[1],g=d.options.animations.easing;switch(a){case"in":d.options.animations.enabled&&(d.$components.notification.style.transition="box-shadow "+e/1.5+"s "+g[0]+" "+e/1.5+"s, opacity "+e+"s "+g[0],d.$components.background.style.transition="transform "+e+"s "+g[0],d.options.symbol.visible&&(d.$components.symbol.style.transition="opacity "+e+"s "+g[0]),d.options.message.visible&&(d.$components.message.style.transition="transform "+e+"s "+g[0]+", opacity "+e+"s "+g[0]),d.options.dismiss.visible&&(d.$components.button.style.transition="opacity "+e/1.5+"s "+g[0]+" "+e/1.5+"s")),c(),d.$components.notification.classList.add("is-visible");break;case"out":d.options.animations.enabled&&(d.$components.notification.style.transition="box-shadow "+f+"s "+g[1]+", opacity "+f+"s "+g[1],d.$components.background.style.transition="transform 0s linear "+f+"s",d.options.symbol.visible&&(d.$components.symbol.style.transition="opacity 0s linear "+f+"s"),d.options.message.visible&&(d.$components.message.style.transition="transform 0s linear "+f+"s, opacity 0s linear "+f+"s"),d.options.dismiss.visible&&(d.$components.button.style.transition="opacity 0s linear "+f+"s")),c(),d.$components.notification.classList.remove("is-visible")}d.options.animations.enabled?d.$components.notification.addEventListener("transitionend",function a(){d.$components.notification.removeEventListener("transitionend",a),d.next(b)}):d.next(b)},f.prototype.shift=function(a,b,c,d){function e(){var a=i.options.animations,b=new Date,c=a.enabled?(b-j)/(1e3*a.duration[0]/1.5):1;1>c?(g(h(c)),requestAnimationFrame(e)):(g(1),i.next(d))}function g(a){for(var d,e,g,h=k-1;h>=0;h--){if(h!==k-1)d+=p[h+1]+m;else if("up"===b)d=0;else{d=c+m;for(var i=l-1;i>k;i--)d+=p[i]+m}e=d+a*(c+m)*("up"===b?1:-1),g="translate("+n+", "+o+e+"px)",f.instances[h].$components.notification.style.webkitTransform=g,f.instances[h].$components.notification.style.transform=g}}function h(a){return.5>a?2*a*a:-1+(4-2*a)*a}var i=this;if(a.length){for(var j=new Date,k=a.length,l=f.instances.length,m=i.options.notification.distances[2],n="middle"===i.options.notification.position[0]?"-50%":"0",o="top"===i.options.notification.position[1]?"+":"-",p=[],q=l-1;q>=0;q--)p[q]=f.instances[q].$components.notification.offsetHeight;requestAnimationFrame(e)}else i.next(d)},f.prototype.next=function(a){"function"==typeof a&&a()};var g=function(a,b){this.duration=a,this.remaining=a,this.callback=b,this.resume()};g.prototype.resume=function(){this.now=new Date,this.timerId=a.setTimeout(this.callback,this.remaining)},g.prototype.pause=function(){a.clearTimeout(this.timerId),this.remaining-=new Date-this.now},g.prototype.stop=function(){a.clearTimeout(this.timerId),this.remaining=this.duration};var h={notify:function(a,b,c){var d=new f(a,b,c);d.build(function(){d.prepare(function(){d.open(function(){d.wait(function(){d.close()})})})})},on:function(a,c){b.addEventListener("notification."+a,c)},off:function(a,c){b.removeEventListener("notification."+a,c)},clearAll:function(a){function b(a){setTimeout(function(){f.instances[a].close()},a*c*1e3)}for(var c="undefined"==typeof a?.15:a,d=f.instances.length,e=d-1;e>=0;e--)c?b(e):f.instances[e].close()},configProfile:function(a,b){if(!d.hasOwnProperty(a))throw new Error("A notification profile with the name <"+a+"> does not exist.");if("undefined"==typeof b)throw new Error("Configuring a profile requires an options object.");for(var c in b){d[a].hasOwnProperty(c)||(d[a][c]={});for(var e in b[c])d[a][c][e]=b[c][e]}},addProfile:function(a,b){if(d.hasOwnProperty(a))throw new Error("A notification profile with the name <"+a+"> already exists.");d[a]="undefined"!=typeof b?b:{}},removeProfile:function(a){if(!d.hasOwnProperty(a))throw new Error("A notification profile with the name <"+a+"> does not exist.");if(-1!==["global","default","info","success","error","warning"].indexOf(a))throw new Error("You cannot delete the <"+a+"> profile.");delete d[a]}};if(a.notification)throw new Error("Global notification object already defined.");a.notification=h}(this,this.document);